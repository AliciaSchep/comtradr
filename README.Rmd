---
output:
  github_document: default
  html_document: default
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

comtradr
=======

[![Travis-CI Build Status](https://travis-ci.org/ChrisMuir/comtradr.svg?branch=master)](https://travis-ci.org/ChrisMuir/comtradr)

R package for interacting with the [UN Comtrade Database](https://comtrade.un.org/data/) public API. UN Comtrade provides historical data on the weights and value of
specific goods shipped between countries, more info can be found [here](https://comtrade.un.org/). Full API documentation can be found
[here](https://comtrade.un.org/data/doc/api/).

This package was inspired by the [R tutorial](https://comtrade.un.org/data/Doc/api/ex/r) posted by Comtrade, and is built using
[httr](https://CRAN.R-project.org/package=httr) and [jsonlite](https://CRAN.R-project.org/package=jsonlite).

Please [report](https://github.com/ChrisMuir/comtradr/issues) issues, comments, or features requests.

## Installation

```{r eval=FALSE}
# install.packages("devtools")
devtools::install_github("ChrisMuir/comtradr")
```

## Example Usage

**Example 1**: Return all exports from China to South Korea, United States and Mexico, for all years

```{r, warning = FALSE, message = FALSE}
library(comtradr)

# First, read in the country code lookup table as a dataframe from Comtrade.
# This will be used as a parameter in the API calls.
countrydf <- ct_countries_table()

# This object can can also be used to look up the exact spellings of countries
# prior to making API calls.
country_lookup("korea", "reporter", countrydf)

# Since we want South Korea, we'll use "Rep. of Korea" within the API query.
example1 <- ct_search(reporters = "China",
                      partners = c("Rep. of Korea", "USA", "Mexico"),
                      countrytable = countrydf,
                      tradedirection = "exports")

# Inspect the return data
str(example1$data)
```

**Example 2**: Return all exports related to shrimp from Thailand to all other countries, for years 2007 thru 2011

```{r, warning = FALSE, message = FALSE}
library(comtradr)

# First, read in the commodity code lookup table as a dataframe from Comtrade.
commoditydf <- ct_commodities_table("HS")

# Then search for shrimp.
commodity_lookup("shrimp", commoditydf)

# API query.
example2 <- ct_search(reporters = "Thailand",
                      partners = "All",
                      countrytable = countrydf,
                      tradedirection = "exports",
                      startdate = "2007-01-01",
                      enddate = "2011-01-01",
                      commodcodes = c("030613",
                                      "030623",
                                      "160520",
                                      "160521",
                                      "160529"))

# Inspect the output
str(example2$data)
```

